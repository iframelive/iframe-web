<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DaddyHD Stream Player</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #1a1a1a;
            color: #fff;
        }
        header {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 20px;
            text-align: center;
            border-bottom: 3px solid #00a8ff;
        }
        h1 { font-size: 28px; color: #00a8ff; text-transform: uppercase; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .layout { display: grid; grid-template-columns: 1fr 320px; gap: 20px; }
        .sidebar {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #444;
        }
        .controls {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #444;
        }
        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        input, button, select {
            padding: 12px;
            border-radius: 6px;
            border: 2px solid #444;
            font-size: 14px;
        }
        input, select {
            flex: 1;
            min-width: 200px;
            background: #383838;
            color: #fff;
            font-family: 'Courier New', monospace;
        }
        button {
            background: #00a8ff;
            color: #000;
            border: none;
            font-weight: 600;
            cursor: pointer;
            min-width: 120px;
            text-transform: uppercase;
        }
        button:hover { background: #0088cc; }
        button.secondary { background: #ff6b00; min-width: 100px; }
        button.secondary:hover { background: #ff8c00; }
        .player {
            background: #2d2d2d;
            border-radius: 10px;
            overflow: hidden;
            border: 2px solid #00a8ff;
            margin-bottom: 20px;
        }
        .player-title {
            background: linear-gradient(90deg, #00a8ff 0%, #0088cc 100%);
            padding: 15px 20px;
            font-weight: 700;
            color: #000;
        }
        .player-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%;
            background: #000;
            height: 0;
            overflow: hidden;
        }
        .player-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        .status {
            padding: 12px;
            border-radius: 6px;
            margin-top: 10px;
            text-align: center;
            display: none;
            font-weight: 600;
        }
        .status.success {
            background: rgba(0, 255, 0, 0.2);
            color: #00ff00;
            border: 1px solid #00ff00;
        }
        .status.error {
            background: rgba(255, 68, 68, 0.2);
            color: #ff4444;
            border: 1px solid #ff4444;
        }
        .status.info {
            background: rgba(100, 150, 255, 0.2);
            color: #6496ff;
            border: 1px solid #6496ff;
        }
        .search-box {
            margin-bottom: 10px;
        }
        .search-box input {
            width: 100%;
            min-width: 0;
        }
        .channels-list {
            max-height: 600px;
            overflow-y: auto;
            margin-top: 10px;
        }
        .channel-btn {
            width: 100%;
            background: #383838;
            color: #fff;
            padding: 10px;
            border: 1px solid #444;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            text-align: left;
            margin-bottom: 5px;
            transition: all 0.2s;
        }
        .channel-btn:hover {
            background: #00a8ff;
            color: #000;
            border-color: #00a8ff;
        }
        .channel-btn.active {
            background: #00a8ff;
            color: #000;
            border-color: #00a8ff;
        }
        .channel-name {
            display: block;
            font-size: 13px;
            font-weight: 600;
        }
        .channel-meta {
            display: block;
            font-size: 11px;
            color: #aaa;
            margin-top: 3px;
        }
        @media (max-width: 768px) {
            .layout { grid-template-columns: 1fr; }
            .main-content { order: -1; }
        }

    </style>
</head>
<body>
<header>
    <h1>ðŸ“º DaddyHD Stream Player</h1>
</header>

<div class="container">
    <div class="layout">
        <div class="main-content">
            <div class="controls">
                <div class="input-group">
                    <input type="text" id="channelId" placeholder="Channel ID (ej: 302)">
                    <select id="folderType">
                        <option value="stream">stream</option>
                        <option value="cast">cast</option>
                        <option value="watch">watch</option>
                        <option value="plus">plus</option>
                        <option value="casting">casting</option>
                        <option value="player">player</option>
                    </select>
                    <button onclick="loadChannel()">Cargar Canal</button>
                    <button onclick="clearStream()" class="secondary">Limpiar</button>
                </div>
                <div class="status" id="status"></div>
            </div>

            <div class="player">
                <div class="player-title" id="playerTitle">Selecciona un canal para reproducir</div>
                <div class="player-container" id="playerContainer">
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); color:#aaa; text-align: center;">
                        <div style="font-size: 14px;">ðŸ“º</div>
                        <div style="font-size: 12px; margin-top: 10px;">Busca un canal o ingresa un ID</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="sidebar">
            <strong style="color:#00a8ff; display:block; margin-bottom:10px;">ðŸ”Ž BUSCAR CANAL</strong>
            <div class="search-box">
                <input type="text" id="searchChannel" placeholder="Escribe nombre del canal...">
            </div>
            <div class="channels-list" id="channelsList">
                <div style="color:#aaa; font-size:12px;">Cargando canales...</div>
            </div>
        </div>
    </div>
</div>

<script>
    var allChannels = [];

    fetch('channels.json')
        .then(function(response) {
            return response.json();
        })
        .then(function(data) {
            allChannels = data;
            showStatus('âœ“ ' + allChannels.length + ' canales cargados', 'success');
        })
        .catch(function(error) {
            showStatus('Error cargando canales', 'error');
            console.error(error);
        });

    function showStatus(msg, type) {
        if (type === undefined) {
            type = 'info';
        }
        var status = document.getElementById('status');
        status.textContent = msg;
        status.className = 'status ' + type;
        status.style.display = 'block';
        if (type !== 'error') {
            setTimeout(function () {
                status.style.display = 'none';
            }, 6000);
        }
    }

    function renderChannelsList(filterText) {
        var list = document.getElementById('channelsList');
        var text = (filterText || '').toLowerCase().trim();

        if (!text) {
            list.innerHTML = '<div style="color:#aaa; font-size:12px;">Empieza a escribir para buscar.</div>';
            return;
        }

        var filtered = allChannels.filter(function (ch) {
            return ch.name.toLowerCase().indexOf(text) !== -1 || ch.id.indexOf(text) !== -1;
        });

        if (filtered.length === 0) {
            list.innerHTML = '<div style="color:#aaa; font-size:12px;">No hay resultados.</div>';
            return;
        }

        var limit = 50;
        var toShow = filtered.slice(0, limit);
        
        list.innerHTML = toShow.map(function (ch) {
            var safeName = ch.name.replace(/'/g, '&#39;').replace(/"/g, '&quot;');
            return (
                '<button class="channel-btn" onclick="selectChannel(\'' + ch.id + '\', \'' + ch.folder + '\')">' +
                    '<span class="channel-name">' + ch.name + '</span>' +
                    '<span class="channel-meta">ID: ' + ch.id + '</span>' +
                '</button>'
            );
        }).join('');
        
        if (filtered.length > limit) {
            list.innerHTML = '<div style="color:#aaa; font-size:12px; margin-bottom:10px;">Mostrando ' + limit + ' de ' + filtered.length + ' resultados</div>' + list.innerHTML;
        }
    }

    function selectChannel(id, folder) {
        document.getElementById('channelId').value = id;
        document.getElementById('folderType').value = folder || 'stream';
        
        var selectedCh = allChannels.find(function(ch) { return ch.id === id; });
        if (selectedCh) {
            showStatus('Canal: ' + selectedCh.name, 'success');
        }
        
        setTimeout(loadChannel, 300);
    }

    function loadChannel() {
        var channelId = document.getElementById('channelId').value.trim();
        var folderType = document.getElementById('folderType').value;

        if (!channelId) {
            showStatus('Por favor ingresa un Channel ID', 'error');
            return;
        }

        if (!/^\d+$/.test(channelId)) {
            showStatus('El Channel ID debe ser numÃ©rico', 'error');
            return;
        }

        var streamUrl = 'https://dlhd.dad/' + folderType + '/stream-' + channelId + '.php';

        showStatus('Cargando stream...', 'success');
        document.getElementById('playerTitle').textContent = 'ðŸ“º Canal #' + channelId + ' - ' + folderType;

        var container = document.getElementById('playerContainer');
        container.innerHTML = '<iframe src="' + streamUrl + '" style="position:absolute; top:0; left:0; width:100%; height:100%; border:none;" allowfullscreen allow="autoplay"></iframe>';
    }

    function clearStream() {
        document.getElementById('playerContainer').innerHTML =
            '<div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); color:#aaa; text-align: center;">' +
                '<div style="font-size: 14px;">ðŸ“º</div>' +
                '<div style="font-size: 12px; margin-top: 10px;">Busca un canal o ingresa un ID</div>' +
            '</div>';
        document.getElementById('playerTitle').textContent = 'Selecciona un canal para reproducir';
        document.getElementById('channelId').value = '';
        var status = document.getElementById('status');
        status.style.display = 'none';
    }

    document.getElementById('channelId').addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
            loadChannel();
        }
    });

    document.getElementById('searchChannel').addEventListener('input', function (e) {
        renderChannelsList(e.target.value);
    });
</script>
</body>
</html>
